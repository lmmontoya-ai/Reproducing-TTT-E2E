[2026-02-13 09:14:00,124][ttt.train][INFO] - Launching Phase-1 runtime with config:
{'backend': {'backend': 'gpu',
             'compilation_cache_dir': '/tmp/jax_cache',
             'coordinator_address': None,
             'distributed': False,
             'local_device_ids': '0,1,2,3,4,5,6,7',
             'num_devices': 8,
             'num_processes': 1,
             'process_id': 0},
 'checkpoint': {'checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import',
                'float_dtype': 'bf16',
                'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-swa-8K-from-import',
                'save_optimizer_state': True},
 'deploy_paths': {'checkpoint': '/private/tmp/external_ckpt_real',
                  'data': {'books3': '/private/tmp/phase1_token_data',
                           'dclm_filter_8k': '/private/tmp/phase1_token_data'}},
 'model': {'attention_pattern': 'ttt_swa',
           'attn_pdrop': 0.0,
           'bos_token_id': 151643,
           'compute_dtype': 'bf16',
           'embd_pdrop': 0.0,
           'eos_token_id': 151643,
           'feed_forward_prime': 'swiglu',
           'force_flash': False,
           'hidden_size': 896,
           'initializer_range': 0.02,
           'intermediate_size': 4864,
           'mini_batch_size': 1024,
           'name': 'qwen2_5_0_5b',
           'num_attention_heads': 14,
           'num_hidden_layers': 24,
           'num_key_value_heads': 2,
           'output_size': 32000,
           'param_dtype': 'fp32',
           'post_norm': True,
           'pre_norm': True,
           'prime': True,
           'qk_norm': True,
           'remat_attention': '',
           'remat_attention_bwd': '',
           'remat_block': '',
           'remat_block_bwd': '',
           'remat_mlp': '',
           'remat_mlp_bwd': '',
           'remat_multiple_gd': '',
           'remat_prefix_block': 'nothing_saveable',
           'remat_rms': '',
           'remat_rms_bwd': '',
           'resid_pdrop': 0.0,
           'rms_norm_eps': 1e-06,
           'rope_theta': 1000000.0,
           'seq_len': 32768,
           'seq_modeling_block': 'SWA',
           'sliding_window_size': 8192,
           'state_dtype': 'fp32',
           'suffix_len': 6,
           'tie_word_embeddings': True,
           'unroll_block_scan': True,
           'unroll_inner_scan': False,
           'vocab_size': 151936},
 'training': {'accum_steps': 1,
              'adapter_recipe': 'ttt_bridge',
              'break_step': -1,
              'checkpoint_path': '/private/tmp/external_ckpt_real',
              'data_seed': 0,
              'data_split': 'train',
              'dataset_name': 'dclm_filter_8k',
              'dataset_path': '/private/tmp/phase1_token_data',
              'dummy_dataset': False,
              'eval_batch_size': 8,
              'eval_mode': False,
              'eval_split': 'val',
              'exp_dir': '/private/tmp/external_phase1_real',
              'exp_folder': 'external_qwen_adapter_smoke',
              'exp_name': 'adapt-qwen05-e2e-8K-from-import',
              'external_model_id': 'Qwen/Qwen2.5-0.5B',
              'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json',
              'global_batch_size': 2,
              'ilr_init': 0.1,
              'ilr_warmup_steps': 1200,
              'init_source': <InitSource.external_hf: 'external_hf'>,
              'inner_remat_freq': 1,
              'load_part': <LoadPart.params: 'params'>,
              'loader_workers': 32,
              'log_wandb': True,
              'model_seed': 0,
              'n_data_parallel': None,
              'n_state_parallel': 1,
              'optimizer_inner': {'b1': '???',
                                  'b2': '???',
                                  'bf16_momentum': '???',
                                  'clip_gradient': 1.0,
                                  'end_lr': '???',
                                  'init_lr': '???',
                                  'lr': 1.0,
                                  'lr_decay_steps': '???',
                                  'lr_warmup_steps': '???',
                                  'optimizer_type': <OptimizerType.sgd: 'sgd'>,
                                  'weight_decay': '???'},
              'optimizer_outer': {'b1': 0.9,
                                  'b2': 0.95,
                                  'bf16_momentum': False,
                                  'clip_gradient': 1.0,
                                  'emb_wd': True,
                                  'end_lr': 1e-05,
                                  'init_lr': 0.0,
                                  'lr': 0.0012,
                                  'lr_decay_steps': 12000,
                                  'lr_warmup_steps': 1200,
                                  'optimizer_type': <OptimizerType.adamw: 'adamw'>,
                                  'weight_decay': 0.1},
              'resume_exp_name': 'adapt-qwen05-swa-8K-from-import',
              'resume_step': None,
              'runtime_mode': <RuntimeMode.token_stats: 'token_stats'>,
              'save_milestone_freq': 1,
              'seq_length': 64,
              'spec_inner': ['language_model.**.suffix_blocks.feed_forward_prime.**'],
              'spec_outer': ['**'],
              'tokenizer_name': 'meta-llama/Llama-2-7b-hf',
              'total_steps': 1,
              'train_mode': <TrainMode.meta: 'meta'>,
              'wandb_entity': 'phase1',
              'wandb_key': 'none',
              'wandb_project': 'phase1'}}
[2026-02-13 09:14:00,129][ttt.train][INFO] - Phase 1 runtime initialized.
[2026-02-13 09:14:00,129][ttt.train][INFO] - run_dir=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import
[2026-02-13 09:14:00,129][ttt.train][INFO] - train_mode=meta
[2026-02-13 09:14:00,129][ttt.train][INFO] - dataset_name=dclm_filter_8k
[2026-02-13 09:14:00,129][ttt.train][INFO] - dataset_path=/private/tmp/phase1_token_data
[2026-02-13 09:14:00,129][ttt.train][INFO] - seq_length=64
[2026-02-13 09:14:00,129][ttt.train][INFO] - global_batch_size=2
[2026-02-13 09:14:00,129][ttt.train][INFO] - resolved_config=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import/phase1_resolved_config.yaml
[2026-02-13 09:14:00,129][ttt.train][INFO] - runtime_mode=token_stats
[2026-02-13 09:14:00,130][ttt.train][INFO] - Token-stats runtime starting: start_step=0 total_steps=1 init={'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_bridge', 'external_profile_status': 'provided'} restore={'load_part': 'params', 'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-swa-8K-from-import', 'resume_exp_name': 'adapt-qwen05-swa-8K-from-import', 'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_bridge', 'external_profile_status': 'provided', 'restore_status': 'ok', 'restore_step': 0}
[2026-02-13 09:14:00,132][ttt.train][INFO] - step=0/1 loss=11.8333 grad_norm=2.4667 lr=1e-06 tokens=128
[2026-02-13 09:14:00,132][ttt.train][INFO] - Saved token-stats checkpoint: /private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import/phase1_ckpt_step_00000000.json
[2026-02-13 09:14:00,132][ttt.train][INFO] - Token-stats runtime finished in 0.00s; metrics=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import/phase1_metrics.jsonl
[2026-02-13 09:14:00,365][ttt.train][INFO] - Launching Phase-1 runtime with config:
{'backend': {'backend': 'gpu',
             'compilation_cache_dir': '/tmp/jax_cache',
             'coordinator_address': None,
             'distributed': False,
             'local_device_ids': '0,1,2,3,4,5,6,7',
             'num_devices': 8,
             'num_processes': 1,
             'process_id': 0},
 'checkpoint': {'checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-bridge',
                'float_dtype': 'bf16',
                'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import',
                'save_optimizer_state': True},
 'deploy_paths': {'checkpoint': '/private/tmp/external_ckpt_real',
                  'data': {'books3': '/private/tmp/phase1_token_data',
                           'dclm_filter_8k': '/private/tmp/phase1_token_data'}},
 'model': {'attention_pattern': 'ttt_swa',
           'attn_pdrop': 0.0,
           'bos_token_id': 151643,
           'compute_dtype': 'bf16',
           'embd_pdrop': 0.0,
           'eos_token_id': 151643,
           'feed_forward_prime': 'swiglu',
           'force_flash': False,
           'hidden_size': 896,
           'initializer_range': 0.02,
           'intermediate_size': 4864,
           'mini_batch_size': 1024,
           'name': 'qwen2_5_0_5b',
           'num_attention_heads': 14,
           'num_hidden_layers': 24,
           'num_key_value_heads': 2,
           'output_size': 32000,
           'param_dtype': 'fp32',
           'post_norm': True,
           'pre_norm': True,
           'prime': True,
           'qk_norm': True,
           'remat_attention': '',
           'remat_attention_bwd': '',
           'remat_block': '',
           'remat_block_bwd': '',
           'remat_mlp': '',
           'remat_mlp_bwd': '',
           'remat_multiple_gd': '',
           'remat_prefix_block': 'nothing_saveable',
           'remat_rms': '',
           'remat_rms_bwd': '',
           'resid_pdrop': 0.0,
           'rms_norm_eps': 1e-06,
           'rope_theta': 1000000.0,
           'seq_len': 32768,
           'seq_modeling_block': 'SWA',
           'sliding_window_size': 8192,
           'state_dtype': 'fp32',
           'suffix_len': 6,
           'tie_word_embeddings': True,
           'unroll_block_scan': True,
           'unroll_inner_scan': False,
           'vocab_size': 151936},
 'training': {'accum_steps': 1,
              'adapter_recipe': 'ttt_bridge',
              'break_step': -1,
              'checkpoint_path': '/private/tmp/external_ckpt_real',
              'data_seed': 0,
              'data_split': 'train',
              'dataset_name': 'books3',
              'dataset_path': '/private/tmp/phase1_token_data',
              'dummy_dataset': False,
              'eval_batch_size': 8,
              'eval_mode': False,
              'eval_split': 'val',
              'exp_dir': '/private/tmp/external_phase1_real',
              'exp_folder': 'external_qwen_adapter_smoke',
              'exp_name': 'ext-qwen05-e2e-32K-from-import-bridge',
              'external_model_id': 'Qwen/Qwen2.5-0.5B',
              'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json',
              'global_batch_size': 2,
              'ilr_init': 1.0,
              'ilr_warmup_steps': 0,
              'init_source': <InitSource.external_hf: 'external_hf'>,
              'inner_remat_freq': 1,
              'load_part': <LoadPart.params: 'params'>,
              'loader_workers': 32,
              'log_wandb': True,
              'model_seed': 0,
              'n_data_parallel': None,
              'n_state_parallel': 1,
              'optimizer_inner': {'b1': '???',
                                  'b2': '???',
                                  'bf16_momentum': '???',
                                  'clip_gradient': 1.0,
                                  'end_lr': '???',
                                  'init_lr': '???',
                                  'lr': 1.0,
                                  'lr_decay_steps': '???',
                                  'lr_warmup_steps': '???',
                                  'optimizer_type': <OptimizerType.sgd: 'sgd'>,
                                  'weight_decay': '???'},
              'optimizer_outer': {'b1': 0.9,
                                  'b2': 0.95,
                                  'bf16_momentum': False,
                                  'clip_gradient': 1.0,
                                  'emb_wd': True,
                                  'end_lr': 1e-05,
                                  'init_lr': 0.0,
                                  'lr': 0.0004,
                                  'lr_decay_steps': 300,
                                  'lr_warmup_steps': 30,
                                  'optimizer_type': <OptimizerType.adamw: 'adamw'>,
                                  'weight_decay': 0.1},
              'resume_exp_name': 'adapt-qwen05-e2e-8K-from-import',
              'resume_step': None,
              'runtime_mode': <RuntimeMode.token_stats: 'token_stats'>,
              'save_milestone_freq': 1,
              'seq_length': 64,
              'spec_inner': ['language_model.**.suffix_blocks.feed_forward_prime.**'],
              'spec_outer': ['**'],
              'tokenizer_name': 'meta-llama/Llama-2-7b-hf',
              'total_steps': 1,
              'train_mode': <TrainMode.meta: 'meta'>,
              'wandb_entity': 'phase1',
              'wandb_key': 'none',
              'wandb_project': 'phase1'}}
[2026-02-13 09:14:00,370][ttt.train][INFO] - Phase 1 runtime initialized.
[2026-02-13 09:14:00,370][ttt.train][INFO] - run_dir=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-bridge
[2026-02-13 09:14:00,370][ttt.train][INFO] - train_mode=meta
[2026-02-13 09:14:00,370][ttt.train][INFO] - dataset_name=books3
[2026-02-13 09:14:00,370][ttt.train][INFO] - dataset_path=/private/tmp/phase1_token_data
[2026-02-13 09:14:00,370][ttt.train][INFO] - seq_length=64
[2026-02-13 09:14:00,370][ttt.train][INFO] - global_batch_size=2
[2026-02-13 09:14:00,370][ttt.train][INFO] - resolved_config=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-bridge/phase1_resolved_config.yaml
[2026-02-13 09:14:00,370][ttt.train][INFO] - runtime_mode=token_stats
[2026-02-13 09:14:00,371][ttt.train][INFO] - Token-stats runtime starting: start_step=0 total_steps=1 init={'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_bridge', 'external_profile_status': 'provided'} restore={'load_part': 'params', 'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/adapt-qwen05-e2e-8K-from-import', 'resume_exp_name': 'adapt-qwen05-e2e-8K-from-import', 'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_bridge', 'external_profile_status': 'provided', 'restore_status': 'ok', 'restore_step': 0}
[2026-02-13 09:14:00,373][ttt.train][INFO] - step=0/1 loss=11.7877 grad_norm=2.4575 lr=1.33333e-05 tokens=128
[2026-02-13 09:14:00,373][ttt.train][INFO] - Saved token-stats checkpoint: /private/tmp/external_ckpt_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-bridge/phase1_ckpt_step_00000000.json
[2026-02-13 09:14:00,373][ttt.train][INFO] - Token-stats runtime finished in 0.00s; metrics=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-bridge/phase1_metrics.jsonl
[2026-02-13 09:14:00,606][ttt.train][INFO] - Launching Phase-1 runtime with config:
{'backend': {'backend': 'gpu',
             'compilation_cache_dir': '/tmp/jax_cache',
             'coordinator_address': None,
             'distributed': False,
             'local_device_ids': '0,1,2,3,4,5,6,7',
             'num_devices': 8,
             'num_processes': 1,
             'process_id': 0},
 'checkpoint': {'checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-direct',
                'float_dtype': 'bf16',
                'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/pretrain-qwen05-fa-import-8K',
                'save_optimizer_state': True},
 'deploy_paths': {'checkpoint': '/private/tmp/external_ckpt_real',
                  'data': {'books3': '/private/tmp/phase1_token_data',
                           'dclm_filter_8k': '/private/tmp/phase1_token_data'}},
 'model': {'attention_pattern': 'ttt_swa',
           'attn_pdrop': 0.0,
           'bos_token_id': 151643,
           'compute_dtype': 'bf16',
           'embd_pdrop': 0.0,
           'eos_token_id': 151643,
           'feed_forward_prime': 'swiglu',
           'force_flash': False,
           'hidden_size': 896,
           'initializer_range': 0.02,
           'intermediate_size': 4864,
           'mini_batch_size': 1024,
           'name': 'qwen2_5_0_5b',
           'num_attention_heads': 14,
           'num_hidden_layers': 24,
           'num_key_value_heads': 2,
           'output_size': 32000,
           'param_dtype': 'fp32',
           'post_norm': True,
           'pre_norm': True,
           'prime': True,
           'qk_norm': True,
           'remat_attention': '',
           'remat_attention_bwd': '',
           'remat_block': '',
           'remat_block_bwd': '',
           'remat_mlp': '',
           'remat_mlp_bwd': '',
           'remat_multiple_gd': '',
           'remat_prefix_block': 'nothing_saveable',
           'remat_rms': '',
           'remat_rms_bwd': '',
           'resid_pdrop': 0.0,
           'rms_norm_eps': 1e-06,
           'rope_theta': 1000000.0,
           'seq_len': 32768,
           'seq_modeling_block': 'SWA',
           'sliding_window_size': 8192,
           'state_dtype': 'fp32',
           'suffix_len': 6,
           'tie_word_embeddings': True,
           'unroll_block_scan': True,
           'unroll_inner_scan': False,
           'vocab_size': 151936},
 'training': {'accum_steps': 1,
              'adapter_recipe': 'ttt_direct',
              'break_step': -1,
              'checkpoint_path': '/private/tmp/external_ckpt_real',
              'data_seed': 0,
              'data_split': 'train',
              'dataset_name': 'books3',
              'dataset_path': '/private/tmp/phase1_token_data',
              'dummy_dataset': False,
              'eval_batch_size': 8,
              'eval_mode': False,
              'eval_split': 'val',
              'exp_dir': '/private/tmp/external_phase1_real',
              'exp_folder': 'external_qwen_adapter_smoke',
              'exp_name': 'ext-qwen05-e2e-32K-from-import-direct',
              'external_model_id': 'Qwen/Qwen2.5-0.5B',
              'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json',
              'global_batch_size': 2,
              'ilr_init': 1.0,
              'ilr_warmup_steps': 0,
              'init_source': <InitSource.external_hf: 'external_hf'>,
              'inner_remat_freq': 1,
              'load_part': <LoadPart.params: 'params'>,
              'loader_workers': 32,
              'log_wandb': True,
              'model_seed': 0,
              'n_data_parallel': None,
              'n_state_parallel': 1,
              'optimizer_inner': {'b1': '???',
                                  'b2': '???',
                                  'bf16_momentum': '???',
                                  'clip_gradient': 1.0,
                                  'end_lr': '???',
                                  'init_lr': '???',
                                  'lr': 1.0,
                                  'lr_decay_steps': '???',
                                  'lr_warmup_steps': '???',
                                  'optimizer_type': <OptimizerType.sgd: 'sgd'>,
                                  'weight_decay': '???'},
              'optimizer_outer': {'b1': 0.9,
                                  'b2': 0.95,
                                  'bf16_momentum': False,
                                  'clip_gradient': 1.0,
                                  'emb_wd': True,
                                  'end_lr': 1e-05,
                                  'init_lr': 0.0,
                                  'lr': 0.0004,
                                  'lr_decay_steps': 300,
                                  'lr_warmup_steps': 30,
                                  'optimizer_type': <OptimizerType.adamw: 'adamw'>,
                                  'weight_decay': 0.1},
              'resume_exp_name': 'pretrain-qwen05-fa-import-8K',
              'resume_step': None,
              'runtime_mode': <RuntimeMode.token_stats: 'token_stats'>,
              'save_milestone_freq': 1,
              'seq_length': 64,
              'spec_inner': ['language_model.**.suffix_blocks.feed_forward_prime.**'],
              'spec_outer': ['**'],
              'tokenizer_name': 'meta-llama/Llama-2-7b-hf',
              'total_steps': 1,
              'train_mode': <TrainMode.meta: 'meta'>,
              'wandb_entity': 'phase1',
              'wandb_key': 'none',
              'wandb_project': 'phase1'}}
[2026-02-13 09:14:00,611][ttt.train][INFO] - Phase 1 runtime initialized.
[2026-02-13 09:14:00,611][ttt.train][INFO] - run_dir=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-direct
[2026-02-13 09:14:00,611][ttt.train][INFO] - train_mode=meta
[2026-02-13 09:14:00,611][ttt.train][INFO] - dataset_name=books3
[2026-02-13 09:14:00,611][ttt.train][INFO] - dataset_path=/private/tmp/phase1_token_data
[2026-02-13 09:14:00,611][ttt.train][INFO] - seq_length=64
[2026-02-13 09:14:00,611][ttt.train][INFO] - global_batch_size=2
[2026-02-13 09:14:00,611][ttt.train][INFO] - resolved_config=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-direct/phase1_resolved_config.yaml
[2026-02-13 09:14:00,611][ttt.train][INFO] - runtime_mode=token_stats
[2026-02-13 09:14:00,612][ttt.train][INFO] - Token-stats runtime starting: start_step=0 total_steps=1 init={'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_direct', 'external_profile_status': 'provided'} restore={'load_part': 'params', 'resume_checkpoint_dir': '/private/tmp/external_ckpt_real/external_qwen_adapter_smoke/pretrain-qwen05-fa-import-8K', 'resume_exp_name': 'pretrain-qwen05-fa-import-8K', 'init_source': 'external_hf', 'external_model_id': 'Qwen/Qwen2.5-0.5B', 'external_profile_path': '/private/tmp/external_profiles_test/qwen2_5_0_5b/model_profile.json', 'adapter_recipe': 'ttt_direct', 'external_profile_status': 'provided', 'restore_status': 'ok', 'restore_step': 0}
[2026-02-13 09:14:00,614][ttt.train][INFO] - step=0/1 loss=11.8810 grad_norm=2.4762 lr=1.33333e-05 tokens=128
[2026-02-13 09:14:00,614][ttt.train][INFO] - Saved token-stats checkpoint: /private/tmp/external_ckpt_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-direct/phase1_ckpt_step_00000000.json
[2026-02-13 09:14:00,614][ttt.train][INFO] - Token-stats runtime finished in 0.00s; metrics=/private/tmp/external_phase1_real/external_qwen_adapter_smoke/ext-qwen05-e2e-32K-from-import-direct/phase1_metrics.jsonl
